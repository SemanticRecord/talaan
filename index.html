<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Talaan by SemanticRecord</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Talaan</h1>
      <h2 class="project-tagline">Semantic logging in Java over SLF4J</h2>
      <a href="https://github.com/SemanticRecord/talaan" class="btn">View on GitHub</a>
      <a href="https://github.com/SemanticRecord/talaan/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/SemanticRecord/talaan/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="talaan" class="anchor" href="#talaan" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Talaan</h1>

<p>Semantic logging in Java over SLF4J</p>

<p>Build status: <a href="https://travis-ci.org/SemanticRecord/talaan" title="Travis CI Build"><img src="https://travis-ci.org/SemanticRecord/talaan.svg?branch=master" alt="Build Status"></a></p>

<p>Talaan is a simple wrapper for <a href="http://www.slf4j.org/">SLF4J</a> based loggers which adds the ability to
generate log statements by calling Java interface methods instead of having
strings scattered throughout your codebase. In addition, the library promotes
structured, strongly-typed, semantic logging instead of the more common
unstructured logging used in most projects. Using semantic logging instead of
unstructured logging helps your logs to be more easily consumed by tools such as
Splunk.</p>

<p>An example of a typical unstructured log statement might look like the following:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(<span class="pl-smi">YourClass</span><span class="pl-k">.</span>class);
<span class="pl-smi">String</span> user <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Rick Grimes<span class="pl-pds">"</span></span>;
<span class="pl-smi">LocalDate</span> businessDate <span class="pl-k">=</span> <span class="pl-smi">LocalDate</span><span class="pl-k">.</span>of(<span class="pl-c1">2016</span>, <span class="pl-c1">7</span>, <span class="pl-c1">1</span>);
<span class="pl-smi">String</span> company <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Alexandria<span class="pl-pds">"</span></span>;
logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Looking up invoices for user {} on date {} in company {}<span class="pl-pds">"</span></span>, 
             user, businessDate, company);
<span class="pl-c">// business logic to perform lookup</span></pre></div>

<p>Logged output will look like the following:</p>

<div class="highlight highlight-text-shell-session"><pre><span class="pl-mo">  INFO Looking up invoices for user Rick Grimes on date 2016-07-01 in company Alexandria</span></pre></div>

<p>A semantic approach would make it more machine readable: </p>

<div class="highlight highlight-source-java"><pre>logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>event={}, user={}, businessDate={}, company={}<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>lookupInvoices<span class="pl-pds">"</span></span>, 
            user, businessDate, company);</pre></div>

<p>Output will be: </p>

<div class="highlight highlight-text-shell-session"><pre><span class="pl-mo">  INFO event=lookupInvoices, user=Rick Grimes, businessDate=2016-07-01, company=Alexandria</span></pre></div>

<p>The preceding example makes logging statements consistent and easier to parse
but we still end up with a bunch of strings scattered over our code base.  We also must remain disciplined across the codebase if we want logging statements which will be easily consumed by our log analysis tools.  If we
had an interface that we could call with strongly typed arguments then the
logging statement and its parameters can be derived automatically. </p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-en">BusinessLogger</span> { 
  <span class="pl-k">void</span> <span class="pl-en">lookupInvoices</span>(<span class="pl-smi">String</span> <span class="pl-v">user</span>, <span class="pl-smi">LocalDate</span> <span class="pl-v">businessDate</span>, <span class="pl-smi">String</span> <span class="pl-v">company</span>);
}
<span class="pl-smi">BusinessLogger</span> logger <span class="pl-k">=</span> <span class="pl-smi">SemanticLogger</span><span class="pl-k">.</span>getLogger(<span class="pl-smi">BusinessLogger</span><span class="pl-k">.</span>class);
logger<span class="pl-k">.</span>lookupInvoices(user, businessDate, company);</pre></div>

<p>The output will be the same as the preceding example.</p>

<p>The advantages you get from such an approach are the following:</p>

<ul>
<li>Consistent formatting in log statements</li>
<li>Easier refactoring</li>
<li>Logging methods centralized into a single place</li>
<li>Find callers of the logging statement across your project</li>
<li>Strong types help promote less defects</li>
<li>The possibility to mock the logging interface allows for fine-grained verification of the code</li>
</ul>

<h2>
<a id="additional-features" class="anchor" href="#additional-features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Additional Features</h2>

<p>Talaan features an annotation to customize event messages, control logging level, and enrich the 
log statements with specific application codes.  Throwable's stack traces can also be included by 
adding the throwable as the last parameter to the method signature.  For example:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">@LogMessage</span>(<span class="pl-c1">level</span> <span class="pl-k">=</span> <span class="pl-smi">Level</span><span class="pl-c1"><span class="pl-k">.</span>ERROR</span>, <span class="pl-c1">eventId</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>INVOICEAPP-1001<span class="pl-pds">"</span></span>)
<span class="pl-k">void</span> problemSavingRecord(<span class="pl-k">long</span> invoiceId, <span class="pl-smi">Stopwatch</span> elapsedTime, <span class="pl-smi">Throwable</span> t);</pre></div>

<p>Will be output similarly to:</p>

<div class="highlight highlight-text-shell-session"><pre><span class="pl-mo">ERROR event=problemSavingRecord, eventId=INVOICEAPP-1001, invoiceId=1, elapsedTime=61.61 Î¼s</span>
<span class="pl-mo">java.lang.RuntimeException: Expected exception message</span>
<span class="pl-mo">    at org.semanticrecord.talaan.SemanticLoggerTest.testThrowable(SemanticLoggerTest.java:92)</span>
<span class="pl-mo">    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span>
<span class="pl-mo">    ...</span></pre></div>

<p><em>Note:</em></p>

<p>This project requires features from Java 8. In particular, in order to get
meaningful names for parameters declared on semantic logger interfaces you must
compile with the <code>-parameters</code> flag turned on. If using Maven a snippet similar
to the following should suffice:</p>

<div class="highlight highlight-text-xml"><pre>    &lt;<span class="pl-ent">plugin</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;org.apache.maven.plugins&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;maven-compiler-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;<span class="pl-ent">version</span>&gt;3.5.1&lt;/<span class="pl-ent">version</span>&gt;
        &lt;<span class="pl-ent">configuration</span>&gt;
            &lt;<span class="pl-ent">source</span>&gt;1.8&lt;/<span class="pl-ent">source</span>&gt;
            &lt;<span class="pl-ent">target</span>&gt;1.8&lt;/<span class="pl-ent">target</span>&gt;
            &lt;<span class="pl-ent">compilerArgs</span>&gt;
                &lt;<span class="pl-ent">arg</span>&gt;-parameters&lt;/<span class="pl-ent">arg</span>&gt;
            &lt;/<span class="pl-ent">compilerArgs</span>&gt;
        &lt;/<span class="pl-ent">configuration</span>&gt;
    &lt;/<span class="pl-ent">plugin</span>&gt;</pre></div>

<h2>
<a id="similar-work" class="anchor" href="#similar-work" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Similar Work</h2>

<p>This project was inspired by the <a href="https://developer.jboss.org/wiki/JBossLoggingTooling">JBoss Logging Tools</a> project which takes an annotation based approach as well.  It differs from Talaan in that its primary focus seems to be on internationalization (i18n) support.  Talaan fulfills a different use case and requires no code generation.</p>

<p>There is also <a href="https://github.com/UnquietCode/LogMachine">LogMachine</a> which takes a <a href="https://en.wikipedia.org/wiki/Fluent_interface">Fluent API</a> approach.  LogMachine also provides extra formatting syntax and an interesting Topic-based logging functionality.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/SemanticRecord/talaan">Talaan</a> is maintained by <a href="https://github.com/SemanticRecord">SemanticRecord</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
